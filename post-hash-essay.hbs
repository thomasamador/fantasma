{{!--
=============================================================================
ESSAY POST TEMPLATE
=============================================================================

Template for long-form writing with optional sidenotes.
Triggered by adding the internal tag #essay to a post.

LAYOUT:
- Two-column grid on desktop (content + sidenotes)
- Single column with inline notes on mobile
- Subtitle from custom_excerpt field
- Author byline and reading time

SIDENOTES:
On desktop (≥1100px), sidenotes appear in right column.
On mobile, they become inline note blocks.
Add sidenotes using HTML in post content:
<aside class="sidenote">Note text here</aside>

CSS CLASSES (see assets/css/custom.css §12):
- .post-essay: Article wrapper (grid on desktop)
- .essay-content: Main content column
- .essay-sidenotes: Sidenote column
--}}
{{!< default}}

{{#post}}
<article class="post post-essay {{post_class}}">
    <header class="essay-header">
        <hgroup>
            <h1>{{title}}</h1>
            {{#if custom_excerpt}}
                <p class="essay-subtitle">{{custom_excerpt}}</p>
            {{/if}}
        </hgroup>
        
        <div class="essay-meta">
            {{#primary_author}}
                <span class="essay-author">{{name}}</span>
            {{/primary_author}}
            <time datetime="{{date format="YYYY-MM-DD"}}">{{date format="MMMM D, YYYY"}}</time>
            {{#if reading_time}}
                <span class="essay-reading-time">{{reading_time}} min read</span>
            {{/if}}
        </div>

        {{#if feature_image}}
            <figure class="essay-feature-image">
                <img 
                    src="{{img_url feature_image size="l"}}" 
                    alt="{{#if feature_image_alt}}{{feature_image_alt}}{{else}}{{title}}{{/if}}"
                    loading="eager"
                >
                {{#if feature_image_caption}}
                    <figcaption>{{feature_image_caption}}</figcaption>
                {{/if}}
            </figure>
        {{/if}}
    </header>

    {{!-- Main essay content with footnotes support --}}
    <section class="essay-content">
        {{content}}
    </section>

    <footer class="essay-footer">
        {{!-- Tags --}}
        {{#if primary_tag}}
            <p class="essay-tags">
                {{#foreach tags visibility="public"}}
                    <a href="{{url}}">{{name}}</a>{{#unless @last}}, {{/unless}}
                {{/foreach}}
            </p>
        {{/if}}

        {{!-- Author bio --}}
        {{#foreach authors}}
            <section class="essay-author-card">
                {{#if profile_image}}
                    <img 
                        src="{{img_url profile_image size="xs"}}" 
                        alt="{{name}}"
                        class="author-avatar"
                    >
                {{/if}}
                <div>
                    <strong>{{name}}</strong>
                    {{#if bio}}
                        <p>{{bio}}</p>
                    {{/if}}
                </div>
            </section>
        {{/foreach}}
    </footer>
</article>
{{/post}}
